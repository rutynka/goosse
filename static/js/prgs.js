var prgs=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function l(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function d(){return u(" ")}function f(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}let h;function g(t){h=t}const p=[],m=[],$=[],y=[],_=Promise.resolve();let v=!1;function w(t){$.push(t)}const b=new Set;let T=0;function x(){const t=h;do{for(;T<p.length;){const t=p[T];T++,g(t),D(t.$$)}for(g(null),p.length=0,T=0;m.length;)m.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];b.has(e)||(b.add(e),e())}$.length=0}while(p.length);for(;y.length;)y.pop()();v=!1,b.clear(),g(t)}function D(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(w)}}const q=new Set;function k(t,e){-1===t.$$.dirty[0]&&(p.push(t),v||(v=!0,_.then(x)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(a,r,i,c,u,d,f,p=[-1]){const m=h;g(a);const $=a.$$={fragment:null,ctx:null,props:d,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(m?m.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:r.target||m.$$.root};f&&f($.root);let y=!1;if($.ctx=i?i(a,r.props||{},((t,e,...n)=>{const o=n.length?n[0]:e;return $.ctx&&u($.ctx[t],$.ctx[t]=o)&&(!$.skip_bound&&$.bound[t]&&$.bound[t](o),y&&k(a,t)),e})):[],$.update(),y=!0,o($.before_update),$.fragment=!!c&&c($.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);$.fragment&&$.fragment.l(t),t.forEach(l)}else $.fragment&&$.fragment.c();r.intro&&((_=a.$$.fragment)&&_.i&&(q.delete(_),_.i(v))),function(t,n,a,r){const{fragment:i,on_mount:l,on_destroy:c,after_update:u}=t.$$;i&&i.m(n,a),r||w((()=>{const n=l.map(e).filter(s);c?c.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(w)}(a,r.target,r.anchor,r.customElement),x()}var _,v;g(m)}function I(t,e,n){const o=t.slice();return o[20]=e[n],o}function O(t){let e,n,o,s=t[2],a=[];for(let e=0;e<s.length;e+=1)a[e]=E(I(t,s,e));return{c(){e=c("div");for(let t=0;t<a.length;t+=1)a[t].c();n=d(),o=c("div"),o.innerHTML='<span>Less</span> \n\t\t\t<div class="sq tiny sqc-0 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-1 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-2 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-3 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-4 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-5 svelte-1ssaupw"></div> \n\t\t\t<div class="sq tiny sqc-6 svelte-1ssaupw"></div> \n\t\t\t<span>More</span>',f(e,"id","cal"),f(e,"class","days svelte-1ssaupw"),f(o,"class","legend prgs svelte-1ssaupw")},m(t,s){i(t,e,s);for(let t=0;t<a.length;t+=1)a[t].m(e,null);i(t,n,s),i(t,o,s)},p(t,n){if(14&n){let o;for(s=t[2],o=0;o<s.length;o+=1){const r=I(t,s,o);a[o]?a[o].p(r,n):(a[o]=E(r),a[o].c(),a[o].m(e,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=s.length}},d(t){t&&l(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(a,t),t&&l(n),t&&l(o)}}}function S(t){let e,n,o=t[20].eT+"";return{c(){e=c("span"),n=u(o),f(e,"class","sec svelte-1ssaupw")},m(t,o){i(t,e,o),r(e,n)},p(t,e){4&e&&o!==(o=t[20].eT+"")&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(n,o)},d(t){t&&l(e)}}}function E(t){let e,n,o,s,a,u=t[20].eT&&t[1]&&S(t);return{c(){e=c("div"),u&&u.c(),n=d(),f(e,"data-cal",o=t[20].search_date),f(e,"title",s=t[20].title),f(e,"class",a=(t[20].search_date===t[3]?"today ":"")+"sq big sqc-"+t[20].val+" svelte-1ssaupw")},m(t,o){i(t,e,o),u&&u.m(e,null),r(e,n)},p(t,r){t[20].eT&&t[1]?u?u.p(t,r):(u=S(t),u.c(),u.m(e,n)):u&&(u.d(1),u=null),4&r&&o!==(o=t[20].search_date)&&f(e,"data-cal",o),4&r&&s!==(s=t[20].title)&&f(e,"title",s),4&r&&a!==(a=(t[20].search_date===t[3]?"today ":"")+"sq big sqc-"+t[20].val+" svelte-1ssaupw")&&f(e,"class",a)},d(t){t&&l(e),u&&u.d()}}}function F(e){let n,o=e[0]&&O(e);return{c(){var t,e,s;n=c("prgs-calendar"),o&&o.c(),s="prgs svelte-1ssaupw",(e="class")in(t=n)?t[e]="boolean"==typeof t[e]&&""===s||s:f(t,e,s)},m(t,e){i(t,n,e),o&&o.m(n,null)},p(t,[e]){t[0]?o?o.p(t,e):(o=O(t),o.c(),o.m(n,null)):o&&(o.d(1),o=null)},i:t,o:t,d(t){t&&l(n),o&&o.d()}}}function j(t,e,n){let{lang:o="en"}=e,{show:s=!1}=e,{show_time:a=!0}=e,{visible_days:r=14}=e,{days_before_today:i=13}=e,{localstorage_key:l=window.location.href}=e,c={},u=new Date,d=g(u);u.setDate(u.getDate()-i);let f=function(){let t=[],e=new Date;e.setDate(e.getDate()-i);for(let n=0;n<r;n++)t.push({val:0,sec:0,title:h(new Date(e.setDate(e.getDate()+1))),search_date:g(new Date(e.setDate(e.getDate())))});return t}();function h(t){const e=new Intl.DateTimeFormat(o,{year:"numeric"}).format(t),n=new Intl.DateTimeFormat(o,{month:"short"}).format(t);return`${new Intl.DateTimeFormat(o,{day:"2-digit"}).format(t)}-${n}-${e}`}function g(t){return`${new Intl.DateTimeFormat(o,{year:"numeric"}).format(t)}-${new Intl.DateTimeFormat(o,{month:"numeric"}).format(t)}-${new Intl.DateTimeFormat(o,{day:"2-digit"}).format(t)}`}function p(t,e){let n=0,o=parseInt(t.exerciseTime);return o&&0!==o?(n=c[e]?c[e]>o?o:c[e]:o,c[e]=n):c[e]&&(n=c[e]),n}console.log("progress helper loaded v0.1.2");let m=()=>localStorage.getItem(l)?JSON.parse(localStorage.getItem(l)):[];const $=t=>{if(t.collectionName){let e=m();e.push(t),localStorage.setItem(l,JSON.stringify(e))}};return t.$$set=t=>{"lang"in t&&n(5,o=t.lang),"show"in t&&n(0,s=t.show),"show_time"in t&&n(1,a=t.show_time),"visible_days"in t&&n(6,r=t.visible_days),"days_before_today"in t&&n(7,i=t.days_before_today),"localstorage_key"in t&&n(4,l=t.localstorage_key)},[s,a,f,d,l,o,r,i,function(t){return function(t){n(4,l=t.collectionName?t.collectionName:window.location.href),t.collectionName=void 0===t.collectionName?window.location.href:t.collectionName,void 0===t.dT&&(t.dT=g(new Date))}(t=t??{}),t.store_db&&function(t){const e={collectionName:t.collectionName,type:"finish",point:1,percent:100,exerciseTime:void 0!==t&&t.t?t.t:0,correctHit:void 0!==t&&t.correct?t.correct:0,wrongHit:void 0!==t&&t.wrong?t.wrong:0},n=new Request(window.allTheFish.api.progressURL,{method:"PUT"});fetch(n,{credentials:"include",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(e)}).then((function(t){return t.json()})),console.log("fetch or localstorage")}(t),$(t),function(t){let e=Object.keys(t);for(let o=0;o<f.length;o++)-1!==e.indexOf(f[o].search_date)&&(n(2,f[o].val=t[f[o].search_date].hit,f),n(2,f[o].eT=t[f[o].search_date].eT,f))}(function(t){let e={};if(t.length<=0)return console.log("event data not found or invalid localstorage key"),{};for(let n=0;n<t.length;n++){let o=new Date(t[n].dT.replace(" CET",""));if(isNaN(o.getDate()))continue;let s=g(o),a=p(t[n],s);void 0===e[s]?e[s]={hit:1,eT:a}:(e[s].hit=e[s].hit<6?e[s].hit+1:e[s]={hit:7},e[s].eT=a)}return console.log(e),e}(m())),n(0,s=!0),!0}]}return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),N(this,t,j,F,a,{lang:5,show:0,show_time:1,visible_days:6,days_before_today:7,localstorage_key:4,store_progress:8})}get lang(){return this.$$.ctx[5]}set lang(t){this.$$set({lang:t}),x()}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),x()}get show_time(){return this.$$.ctx[1]}set show_time(t){this.$$set({show_time:t}),x()}get visible_days(){return this.$$.ctx[6]}set visible_days(t){this.$$set({visible_days:t}),x()}get days_before_today(){return this.$$.ctx[7]}set days_before_today(t){this.$$set({days_before_today:t}),x()}get localstorage_key(){return this.$$.ctx[4]}set localstorage_key(t){this.$$set({localstorage_key:t}),x()}get store_progress(){return this.$$.ctx[8]}}({target:document.body,props:{}})}();
